<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="NuevoListadoPorAcademia" pageWidth="595" pageHeight="842" whenNoDataType="AllSectionsNoDetail" columnWidth="535" leftMargin="30" rightMargin="30" topMargin="20" bottomMargin="20">
	<property name="ireport.zoom" value="1.5"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<property name="ireport.scriptlethandling" value="0"/>
	<property name="ireport.esconding" value="UTF-8"/>
	<import value="net.sf.jasperreports.engine.*"/>
	<import value="java.util.*"/>
	<import value="net.sf.jasperreports.engine.data.*"/>
	<parameter name="fechadesde" class="java.util.Date"/>
	<parameter name="fechahasta" class="java.util.Date"/>
	<parameter name="cliente_desde" class="java.lang.Integer"/>
	<parameter name="cliente_hasta" class="java.lang.Integer"/>
	<parameter name="academiadesde" class="java.lang.Integer"/>
	<parameter name="academiahasta" class="java.lang.Integer"/>
	<queryString>
		<![CDATA[select procedencias.id as procedencia, procedencias.descripcion as descripcion, episodios.fecha, personas.documento, personas.apellidos, personas.nombres
from
	libretasdeconducir, procedencias, episodios,personas
where
       episodios.id= libretasdeconducir.episodio and
personas.id = episodios.paciente and
procedencias.id = libretasdeconducir.procedencia and
        procedencias.id !=0 and

fecha >= $P{fechadesde} and
fecha <= $P{fechahasta} and
     libretasdeconducir.procedencia >= $P{academiadesde} and
     libretasdeconducir.procedencia <= $P{academiahasta} and
           episodios.cliente >= $P{cliente_desde} and
           episodios.cliente <= $P{cliente_hasta}
group by procedencias.descripcion, episodios.fecha, episodios.paciente
order by procedencias.descripcion, episodios.fecha, personas.apellidos]]>
	</queryString>
	<field name="procedencia" class="java.lang.Integer">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="descripcion" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="fecha" class="java.sql.Date">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="documento" class="java.lang.Integer">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="apellidos" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="nombres" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<variable name="academia" class="java.lang.Integer" resetType="Group" resetGroup="descripcion" calculation="Count">
		<variableExpression><![CDATA[$F{documento}]]></variableExpression>
	</variable>
	<group name="descripcion">
		<groupExpression><![CDATA[$F{descripcion}]]></groupExpression>
		<groupHeader>
			<band height="23">
				<rectangle>
					<reportElement key="rectangle-1" x="0" y="0" width="535" height="20" backcolor="#CCCCCC"/>
					<graphicElement fill="Solid"/>
				</rectangle>
				<textField>
					<reportElement x="118" y="0" width="396" height="20"/>
					<textElement>
						<font size="16" isBold="true" isItalic="false"/>
					</textElement>
					<textFieldExpression class="java.lang.String"><![CDATA[$F{descripcion}]]></textFieldExpression>
				</textField>
				<textField>
					<reportElement x="7" y="3" width="100" height="20"/>
					<textElement/>
					<textFieldExpression class="java.lang.Integer"><![CDATA[$F{procedencia}]]></textFieldExpression>
				</textField>
			</band>
		</groupHeader>
		<groupFooter>
			<band height="22">
				<textField>
					<reportElement x="452" y="0" width="83" height="20"/>
					<textElement/>
					<textFieldExpression class="java.lang.Integer"><![CDATA[$V{academia}]]></textFieldExpression>
				</textField>
				<staticText>
					<reportElement key="staticText-3" x="393" y="0" width="54" height="20"/>
					<textElement>
						<font size="12" isBold="true"/>
					</textElement>
					<text><![CDATA[Total:]]></text>
				</staticText>
			</band>
		</groupFooter>
	</group>
	<title>
		<band height="69" splitType="Stretch">
			<staticText>
				<reportElement key="staticText-2" x="393" y="0" width="46" height="20"/>
				<textElement/>
				<text><![CDATA[Fechas :]]></text>
			</staticText>
			<textField pattern="dd/MM/yyyy">
				<reportElement x="439" y="0" width="96" height="20"/>
				<textElement/>
				<textFieldExpression class="java.util.Date"><![CDATA[$P{fechadesde}]]></textFieldExpression>
			</textField>
			<textField pattern="dd/MM/yyyy">
				<reportElement x="439" y="20" width="96" height="20"/>
				<textElement/>
				<textFieldExpression class="java.util.Date"><![CDATA[$P{fechahasta}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement key="staticText-1" x="0" y="0" width="393" height="20"/>
				<textElement>
					<font size="15" isBold="true"/>
				</textElement>
				<text><![CDATA[LIBRETAS DE CONDUCIR POR ACADEMIA]]></text>
			</staticText>
			<textField>
				<reportElement x="61" y="40" width="26" height="17"/>
				<textElement/>
				<textFieldExpression class="java.lang.Integer"><![CDATA[$P{academiadesde}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="102" y="40" width="58" height="17"/>
				<textElement/>
				<textFieldExpression class="java.lang.Integer"><![CDATA[$P{academiahasta}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="61" y="23" width="26" height="17"/>
				<textElement/>
				<textFieldExpression class="java.lang.Integer"><![CDATA[$P{cliente_desde}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="102" y="23" width="58" height="17"/>
				<textElement/>
				<textFieldExpression class="java.lang.Integer"><![CDATA[$P{cliente_hasta}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement key="staticText-2" x="0" y="23" width="61" height="17"/>
				<textElement/>
				<text><![CDATA[Clientes:]]></text>
			</staticText>
			<staticText>
				<reportElement key="staticText-2" x="87" y="23" width="15" height="17"/>
				<textElement/>
				<text><![CDATA[  -  ]]></text>
			</staticText>
			<staticText>
				<reportElement key="staticText-2" x="0" y="40" width="61" height="17"/>
				<textElement/>
				<text><![CDATA[Academias:]]></text>
			</staticText>
			<staticText>
				<reportElement key="staticText-2" x="87" y="40" width="15" height="17"/>
				<textElement/>
				<text><![CDATA[  -  ]]></text>
			</staticText>
			<line>
				<reportElement key="line" positionType="FixRelativeToBottom" x="0" y="61" width="535" height="1" forecolor="#000000"/>
				<graphicElement>
					<pen lineWidth="2.0" lineStyle="Solid"/>
				</graphicElement>
			</line>
		</band>
	</title>
	<detail>
		<band height="23" splitType="Stretch">
			<textField>
				<reportElement x="146" y="2" width="100" height="20"/>
				<textElement/>
				<textFieldExpression class="java.lang.Integer"><![CDATA[$F{documento}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="249" y="3" width="129" height="20"/>
				<textElement/>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{apellidos}]]></textFieldExpression>
			</textField>
			<textField pattern="dd/MM/yyyy">
				<reportElement x="46" y="2" width="100" height="20"/>
				<textElement/>
				<textFieldExpression class="java.util.Date"><![CDATA[$F{fecha}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="380" y="3" width="150" height="20"/>
				<textElement/>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{nombres}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<pageFooter>
		<band height="25">
			<textField>
				<reportElement x="415" y="5" width="78" height="20"/>
				<textElement textAlignment="Right"/>
				<textFieldExpression class="java.lang.String"><![CDATA["Page "+$V{PAGE_NUMBER}+" of"]]></textFieldExpression>
			</textField>
			<textField evaluationTime="Report">
				<reportElement x="497" y="5" width="38" height="20"/>
				<textElement/>
				<textFieldExpression class="java.lang.String"><![CDATA[" " + $V{PAGE_NUMBER}]]></textFieldExpression>
			</textField>
		</band>
	</pageFooter>
</jasperReport>
