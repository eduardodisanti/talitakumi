<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="ListadoDeServiciosProfesionales" pageWidth="595" pageHeight="842" whenNoDataType="AllSectionsNoDetail" columnWidth="555" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20">
	<property name="ireport.zoom" value="1.5"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<parameter name="fechadesde" class="java.util.Date"/>
	<parameter name="fechahasta" class="java.util.Date"/>
	<parameter name="cliente_desde" class="java.lang.Integer">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="cliente_hasta" class="java.lang.Integer">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="tipo_factura" class="java.lang.String"/>
	<parameter name="emisor" class="java.lang.Integer"/>
	<parameter name="SUBREPORT_DIR" class="java.lang.String" isForPrompting="false">
		<defaultValueExpression><![CDATA["/home/victoria/NetBeansProjects/kcreativa/Medilab/talitakumi/Talitakumi/"]]></defaultValueExpression>
	</parameter>
	<queryString>
		<![CDATA[select
episodios.id as epiid, clientes.id,clientes.nombre,personas.documento, personas.nombres, personas.apellidos, actividades.tipoactividad,actividades.descripcion as nombreac,actividades.id as acid, facturas.tipo, facturas.importe, facturas.descuentos, episodios.fecha, facturas.numero as notiket, consultorios.sucursal as lugar, facturas.emisor as emisor, emisor.nombre as nombreemisor, actividades.tipoactividad as ta

from
clientes, personas, actividades, facturas, episodios, pacientes, agenda, emisor, consultorios

where
((emisor.id = $P{emisor}) or ($P{emisor}=0)) and
facturas.emisor = emisor.id and episodios.paciente=personas.id and facturas.episodio = episodios.id and episodios.cliente = clientes.id and actividades.id = episodios.tipoepisodio and personas.id = pacientes.id and fechaentregado >=$P{fechadesde} and fechaentregado<= $P{fechahasta} and clientes.id >= $P{cliente_desde} and clientes.id <= $P{cliente_hasta} and ((facturas.tipo=$P{tipo_factura}) or ($P{tipo_factura}='T')) and facturas.entregado = 'S' and episodios.id=agenda.episodio and consultorios.id = agenda.consultorio

Order by  facturas.emisor,clientes.nombre,nombreac,lugar, episodios.fecha]]>
	</queryString>
	<field name="epiid" class="java.lang.Integer">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="id" class="java.lang.Integer">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="nombre" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="documento" class="java.lang.Integer">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="nombres" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="apellidos" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="tipoactividad" class="java.lang.Integer">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="nombreac" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="acid" class="java.lang.Integer">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="tipo" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="importe" class="java.lang.Float">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="descuentos" class="java.lang.Integer">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="fecha" class="java.sql.Date">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="notiket" class="java.lang.Integer">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="lugar" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="emisor" class="java.lang.Integer">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="nombreemisor" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="ta" class="java.lang.Integer">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<variable name="cuentaServicios" class="java.lang.Integer" resetType="Group" resetGroup="Servicio" calculation="Count">
		<variableExpression><![CDATA[$F{id}]]></variableExpression>
	</variable>
	<variable name="cuentaImporte" class="java.lang.Float" resetType="Group" resetGroup="Servicio" calculation="Sum">
		<variableExpression><![CDATA[$F{importe}]]></variableExpression>
		<initialValueExpression><![CDATA[]]></initialValueExpression>
	</variable>
	<variable name="cuentaDescuento" class="java.lang.Integer" resetType="Group" resetGroup="Servicio" calculation="Sum">
		<variableExpression><![CDATA[$F{descuentos}]]></variableExpression>
		<initialValueExpression><![CDATA[]]></initialValueExpression>
	</variable>
	<variable name="totalImporte" class="java.lang.Float" calculation="Sum">
		<variableExpression><![CDATA[$F{importe}]]></variableExpression>
	</variable>
	<variable name="totalDescuento" class="java.lang.Integer" calculation="Sum">
		<variableExpression><![CDATA[$F{descuentos}]]></variableExpression>
	</variable>
	<variable name="cantLugar" class="java.lang.Integer" resetType="Group" resetGroup="Lugar" calculation="Count">
		<variableExpression><![CDATA[$F{importe}]]></variableExpression>
	</variable>
	<variable name="impLugar" class="java.lang.Float" resetType="Group" resetGroup="Lugar" calculation="Sum">
		<variableExpression><![CDATA[$F{importe}]]></variableExpression>
	</variable>
	<variable name="CuenServTot" class="java.lang.Integer" calculation="Count">
		<variableExpression><![CDATA[$F{id}]]></variableExpression>
	</variable>
	<variable name="totalempresa" class="java.lang.Float" resetType="Group" resetGroup="cliente" calculation="Sum">
		<variableExpression><![CDATA[$F{importe}]]></variableExpression>
	</variable>
	<group name="emisor" isStartNewPage="true" isReprintHeaderOnEachPage="true">
		<groupExpression><![CDATA[$F{emisor}]]></groupExpression>
		<groupHeader>
			<band height="23">
				<staticText>
					<reportElement x="3" y="0" width="76" height="14"/>
					<textElement>
						<font size="10" isBold="true"/>
					</textElement>
					<text><![CDATA[EMISOR]]></text>
				</staticText>
				<textField>
					<reportElement x="75" y="1" width="446" height="13"/>
					<textElement/>
					<textFieldExpression class="java.lang.String"><![CDATA[$F{nombreemisor}]]></textFieldExpression>
				</textField>
			</band>
		</groupHeader>
	</group>
	<group name="cliente">
		<groupExpression><![CDATA[$F{nombre}]]></groupExpression>
		<groupHeader>
			<band height="23">
				<textField>
					<reportElement x="3" y="3" width="76" height="17"/>
					<textElement/>
					<textFieldExpression class="java.lang.Integer"><![CDATA[$F{id}]]></textFieldExpression>
				</textField>
				<textField>
					<reportElement x="108" y="0" width="446" height="20"/>
					<textElement>
						<font size="14" isBold="true"/>
					</textElement>
					<textFieldExpression class="java.lang.String"><![CDATA[$F{nombre}]]></textFieldExpression>
				</textField>
			</band>
		</groupHeader>
		<groupFooter>
			<band height="20">
				<rectangle>
					<reportElement x="287" y="0" width="267" height="15" forecolor="#999999" backcolor="#CCCCCC"/>
				</rectangle>
				<textField pattern="#,##0.0">
					<reportElement x="487" y="0" width="68" height="15"/>
					<textElement>
						<font isBold="true"/>
					</textElement>
					<textFieldExpression class="java.lang.Float"><![CDATA[$V{totalempresa}]]></textFieldExpression>
				</textField>
				<staticText>
					<reportElement x="288" y="0" width="94" height="20"/>
					<textElement>
						<font isBold="true"/>
					</textElement>
					<text><![CDATA[Total a Facturar]]></text>
				</staticText>
			</band>
		</groupFooter>
	</group>
	<group name="Servicio">
		<groupExpression><![CDATA[$F{nombreac}]]></groupExpression>
		<groupHeader>
			<band height="19">
				<textField>
					<reportElement x="1" y="0" width="553" height="18"/>
					<textElement>
						<font isBold="true" isItalic="false"/>
					</textElement>
					<textFieldExpression class="java.lang.String"><![CDATA[$F{nombreac}]]></textFieldExpression>
				</textField>
			</band>
		</groupHeader>
		<groupFooter>
			<band height="18">
				<textField pattern="#,##0">
					<reportElement x="387" y="0" width="99" height="15"/>
					<textElement>
						<font isBold="true"/>
					</textElement>
					<textFieldExpression class="java.lang.Integer"><![CDATA[$V{cuentaServicios}]]></textFieldExpression>
				</textField>
				<textField pattern="#,##0.0" isBlankWhenNull="false">
					<reportElement x="487" y="0" width="68" height="15"/>
					<textElement>
						<font isBold="true"/>
					</textElement>
					<textFieldExpression class="java.lang.Float"><![CDATA[$V{cuentaImporte}]]></textFieldExpression>
				</textField>
				<elementGroup/>
				<staticText>
					<reportElement x="287" y="0" width="94" height="15"/>
					<textElement>
						<font isBold="true"/>
					</textElement>
					<text><![CDATA[Total personas]]></text>
				</staticText>
			</band>
		</groupFooter>
	</group>
	<group name="Lugar">
		<groupExpression><![CDATA[$F{lugar}]]></groupExpression>
		<groupHeader>
			<band height="13">
				<staticText>
					<reportElement x="79" y="-1" width="46" height="14"/>
					<textElement>
						<font isBold="false"/>
					</textElement>
					<text><![CDATA[Lugar]]></text>
				</staticText>
				<textField>
					<reportElement x="125" y="-1" width="68" height="14"/>
					<textElement>
						<font isBold="true"/>
					</textElement>
					<textFieldExpression class="java.lang.String"><![CDATA[$F{lugar}]]></textFieldExpression>
				</textField>
			</band>
		</groupHeader>
		<groupFooter>
			<band height="18">
				<staticText>
					<reportElement x="288" y="0" width="93" height="15"/>
					<textElement>
						<font isBold="true"/>
					</textElement>
					<text><![CDATA[Total lugar]]></text>
				</staticText>
				<textField pattern="#,##0.0">
					<reportElement x="487" y="0" width="68" height="13"/>
					<textElement>
						<font isBold="true"/>
					</textElement>
					<textFieldExpression class="java.lang.Float"><![CDATA[$V{impLugar}]]></textFieldExpression>
				</textField>
				<textField pattern="#,##0">
					<reportElement x="387" y="0" width="99" height="13"/>
					<textElement>
						<font isBold="true"/>
					</textElement>
					<textFieldExpression class="java.lang.Integer"><![CDATA[$V{cantLugar}]]></textFieldExpression>
				</textField>
			</band>
		</groupFooter>
	</group>
	<title>
		<band splitType="Stretch"/>
	</title>
	<pageHeader>
		<band height="51">
			<textField pattern="dd/MM/yyyy">
				<reportElement x="487" y="1" width="67" height="14"/>
				<textElement/>
				<textFieldExpression class="java.util.Date"><![CDATA[$P{fechadesde}]]></textFieldExpression>
			</textField>
			<textField pattern="dd/MM/yyyy">
				<reportElement x="487" y="15" width="68" height="12"/>
				<textElement/>
				<textFieldExpression class="java.util.Date"><![CDATA[$P{fechahasta}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="410" y="1" width="76" height="12"/>
				<textElement>
					<font size="9" isBold="false"/>
				</textElement>
				<text><![CDATA[Fecha Desde:]]></text>
			</staticText>
			<staticText>
				<reportElement x="410" y="13" width="76" height="14"/>
				<textElement>
					<font size="9" isBold="false"/>
				</textElement>
				<text><![CDATA[Fecha Hasta:]]></text>
			</staticText>
			<staticText>
				<reportElement key="staticText" x="0" y="0" width="410" height="27"/>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center">
					<font size="20" isBold="true"/>
				</textElement>
				<text><![CDATA[Listado de Servicios Profesionales]]></text>
			</staticText>
		</band>
	</pageHeader>
	<columnHeader>
		<band splitType="Stretch"/>
	</columnHeader>
	<detail>
		<band height="13" splitType="Stretch">
			<textField pattern="dd/MM/yyyy">
				<reportElement x="0" y="0" width="64" height="13"/>
				<textElement/>
				<textFieldExpression class="java.util.Date"><![CDATA[$F{fecha}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="65" y="0" width="26" height="13"/>
				<textElement/>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{tipo}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="302" y="0" width="99" height="13"/>
				<textElement>
					<font size="9" isBold="false"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{apellidos}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="408" y="1" width="78" height="12"/>
				<textElement>
					<font size="9" isBold="false"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{nombres}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0">
				<reportElement x="219" y="1" width="87" height="12"/>
				<textElement/>
				<textFieldExpression class="java.lang.Integer"><![CDATA[$F{documento}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="152" y="0" width="62" height="13"/>
				<textElement/>
				<textFieldExpression class="java.lang.Integer"><![CDATA[$F{notiket}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00">
				<reportElement x="486" y="0" width="68" height="13"/>
				<textElement/>
				<textFieldExpression class="java.lang.Float"><![CDATA[$F{importe}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="93" y="1" width="48" height="12"/>
				<textElement/>
				<textFieldExpression class="java.lang.Integer"><![CDATA[$F{ta}]]></textFieldExpression>
			</textField>
		</band>
		<band height="5">
			<subreport>
				<reportElement x="0" y="3" width="553" height="1" isRemoveLineWhenBlank="true"/>
				<subreportParameter name="ADICIONALES">
					<subreportParameterExpression><![CDATA[$F{tipoactividad}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="episodio">
					<subreportParameterExpression><![CDATA[$F{epiid}]]></subreportParameterExpression>
				</subreportParameter>
				<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
				<subreportExpression class="java.lang.String"><![CDATA["AdicionalesPorEpisodio.jasper"]]></subreportExpression>
			</subreport>
		</band>
		<band height="5">
			<subreport>
				<reportElement x="0" y="0" width="554" height="1" isRemoveLineWhenBlank="true">
					<printWhenExpression><![CDATA[new java.lang.Boolean($F{ta}.intValue()==14)]]></printWhenExpression>
				</reportElement>
				<subreportParameter name="episodio">
					<subreportParameterExpression><![CDATA[$F{epiid}]]></subreportParameterExpression>
				</subreportParameter>
				<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
				<subreportExpression class="java.lang.String"><![CDATA["VacunasPorEpisodio.jasper"]]></subreportExpression>
			</subreport>
		</band>
	</detail>
	<pageFooter>
		<band height="50">
			<staticText>
				<reportElement x="1" y="36" width="64" height="14"/>
				<textElement>
					<font size="10" isBold="false"/>
				</textElement>
				<text><![CDATA[Página :	]]></text>
			</staticText>
			<textField pattern="#,##0">
				<reportElement x="65" y="36" width="100" height="14"/>
				<textElement/>
				<textFieldExpression class="java.lang.Integer"><![CDATA[$V{PAGE_NUMBER}]]></textFieldExpression>
			</textField>
		</band>
	</pageFooter>
	<lastPageFooter>
		<band height="20">
			<textField evaluationTime="Report" pattern="#,##0">
				<reportElement x="64" y="1" width="100" height="15"/>
				<textElement/>
				<textFieldExpression class="java.lang.Integer"><![CDATA[$V{PAGE_NUMBER}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="0" y="1" width="64" height="14"/>
				<textElement>
					<font size="10" isBold="false"/>
				</textElement>
				<text><![CDATA[Página :	]]></text>
			</staticText>
		</band>
	</lastPageFooter>
	<summary>
		<band splitType="Stretch"/>
	</summary>
</jasperReport>
