<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="analisislaboratorio" pageWidth="595" pageHeight="842" columnWidth="535" leftMargin="30" rightMargin="30" topMargin="20" bottomMargin="20">
	<property name="ireport.scriptlethandling" value="0"/>
	<property name="ireport.encoding" value="UTF-8"/>
	<property name="ireport.zoom" value="1.0"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<import value="net.sf.jasperreports.engine.*"/>
	<import value="java.util.*"/>
	<import value="net.sf.jasperreports.engine.data.*"/>
	<parameter name="episodiodesde" class="java.lang.Integer"/>
	<parameter name="episodiohasta" class="java.lang.Integer"/>
	<parameter name="internet" class="java.lang.String"/>
	<queryString>
		<![CDATA[select analisishechos.ensuma as ensuma ,analisis.id, analisis.valorrefminimo, analisis.valorrefmaximo, estudios.id as estid,
       estudios.descripcion as estdesc, analisis.descripcion as anadesc,
       valorhallado, tiporesultado, documento, analisis.unidades, episodios.fecha,
       personas.apellidos, personas.nombres, episodios.id as epiid
from estudios, estudioshechos, analisishechos, analisis, personas, episodios
where episodio>=$P{episodiodesde} and
      episodio <=$P{episodiohasta} and
      estudios.id = estudioshechos.estudio and
      analisishechos.estudiohecho = estudioshechos.id and
      analisishechos.analisis = analisis.id and
      episodios.paciente = personas.id and
      episodio = episodios.id and
      analisishechos.valorhallado != ''
      group by personas.id, analisis.id
order by personas.apellidos, personas.nombres, estid, analisis.id]]>
	</queryString>
	<field name="ensuma" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="id" class="java.lang.Integer">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="valorrefminimo" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="valorrefmaximo" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="estid" class="java.lang.Integer">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="estdesc" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="anadesc" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="valorhallado" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="tiporesultado" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="documento" class="java.lang.Integer">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="unidades" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="fecha" class="java.sql.Date">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="apellidos" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="nombres" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="epiid" class="java.lang.Integer">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<group name="PERSONA" isStartNewPage="true">
		<groupExpression><![CDATA[($F{documento})]]></groupExpression>
		<groupHeader>
			<band height="141" splitType="Stretch">
				<textField isBlankWhenNull="false">
					<reportElement key="textField" x="342" y="2" width="89" height="17"/>
					<textElement>
						<font fontName="SansSerif" size="7"/>
					</textElement>
					<textFieldExpression class="java.lang.String"><![CDATA[$F{apellidos}]]></textFieldExpression>
				</textField>
				<textField isBlankWhenNull="false">
					<reportElement key="textField" x="274" y="2" width="67" height="18"/>
					<textElement textAlignment="Left">
						<font fontName="SansSerif" size="7"/>
					</textElement>
					<textFieldExpression class="java.lang.String"><![CDATA[$F{nombres}]]></textFieldExpression>
				</textField>
				<textField isBlankWhenNull="false">
					<reportElement key="textField" x="280" y="50" width="100" height="18"/>
					<textElement/>
					<textFieldExpression class="java.lang.Integer"><![CDATA[$F{documento}]]></textFieldExpression>
				</textField>
				<textField isBlankWhenNull="false">
					<reportElement key="textField" x="473" y="51" width="57" height="18"/>
					<textElement/>
					<textFieldExpression class="java.lang.Integer"><![CDATA[$F{epiid}]]></textFieldExpression>
				</textField>
				<textField pattern="dd/MM/yyyy" isBlankWhenNull="false">
					<reportElement key="textField" x="449" y="2" width="66" height="17"/>
					<textElement>
						<font size="8"/>
					</textElement>
					<textFieldExpression class="java.util.Date"><![CDATA[$F{fecha}]]></textFieldExpression>
				</textField>
				<staticText>
					<reportElement key="staticText-7" mode="Opaque" x="135" y="88" width="265" height="20"/>
					<textElement>
						<font size="14"/>
					</textElement>
					<text><![CDATA[ANALISIS DE LABORATORIO.]]></text>
				</staticText>
				<staticText>
					<reportElement key="staticText-8" x="3" y="122" width="200" height="16"/>
					<textElement/>
					<text><![CDATA[EXAMEN]]></text>
				</staticText>
				<staticText>
					<reportElement key="staticText-9" x="203" y="123" width="121" height="15"/>
					<textElement/>
					<text><![CDATA[VALOR HALLADO]]></text>
				</staticText>
				<staticText>
					<reportElement key="staticText-10" x="345" y="122" width="190" height="14"/>
					<textElement textAlignment="Left"/>
					<text><![CDATA[VALOR DE REFERENCIA]]></text>
				</staticText>
			</band>
		</groupHeader>
		<groupFooter>
			<band height="1" splitType="Stretch"/>
		</groupFooter>
	</group>
	<group name="ESTUDIO">
		<groupExpression><![CDATA[($F{estdesc})]]></groupExpression>
		<groupHeader>
			<band height="20" splitType="Stretch">
				<textField isBlankWhenNull="false">
					<reportElement key="textField" x="0" y="0" width="190" height="18"/>
					<textElement>
						<font isBold="true"/>
					</textElement>
					<textFieldExpression class="java.lang.String"><![CDATA[$F{estdesc}]]></textFieldExpression>
				</textField>
				<line>
					<reportElement key="line-1" x="0" y="0" width="530" height="1"/>
				</line>
			</band>
		</groupHeader>
		<groupFooter>
			<band splitType="Stretch"/>
		</groupFooter>
	</group>
	<background>
		<band splitType="Stretch"/>
	</background>
	<title>
		<band splitType="Stretch"/>
	</title>
	<pageHeader>
		<band splitType="Stretch"/>
	</pageHeader>
	<columnHeader>
		<band splitType="Stretch"/>
	</columnHeader>
	<detail>
		<band height="21" splitType="Stretch">
			<printWhenExpression><![CDATA[new java.lang.Boolean(!$F{anadesc}.equals("HEXAGON"))]]></printWhenExpression>
			<textField isBlankWhenNull="false">
				<reportElement key="textField" x="30" y="0" width="158" height="18"/>
				<textElement/>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{anadesc}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="false">
				<reportElement key="textField" x="188" y="0" width="136" height="18"/>
				<textElement textAlignment="Center"/>
				<textFieldExpression class="java.lang.String"><![CDATA[($F{anadesc}.equals("HEXAGON") && $F{valorhallado}.equals("false")) ?
    new java.lang.String("-") :
    ($F{anadesc}.equals("VDRL") ?
        (
            $F{valorhallado}.equals("true") ? new java.lang.String("REACTIVO")
                : $F{valorhallado}.equals("false") ?  new java.lang.String($F{valorrefminimo})
            : $F{valorhallado}
        ) : (
            $F{valorhallado}.equals("true") ? new java.lang.String("POSITIVO")
                : $F{valorhallado}.equals("false") ?  new java.lang.String($F{valorrefminimo})
            : $F{valorhallado}
            )
    )]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="false">
				<reportElement key="textField" x="324" y="0" width="211" height="18"/>
				<textElement textAlignment="Left"/>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{valorrefminimo} + new java.lang.String(" -" ) +  $F{valorrefmaximo} + new java.lang.String(" ") + $F{unidades}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<columnFooter>
		<band height="54" splitType="Stretch">
			<staticText>
				<reportElement key="staticText-5" mode="Opaque" x="368" y="2" width="166" height="14"/>
				<textElement verticalAlignment="Bottom"/>
				<text><![CDATA[Validado por Dra. Silvia Pigni]]></text>
			</staticText>
			<textField isBlankWhenNull="false">
				<reportElement key="textField" x="27" y="1" width="100" height="18"/>
				<textElement/>
				<textFieldExpression class="java.lang.Integer"><![CDATA[$V{PAGE_NUMBER}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement key="staticText-11" x="3" y="1" width="27" height="17"/>
				<textElement/>
				<text><![CDATA[#]]></text>
			</staticText>
			<staticText>
				<reportElement key="staticText-8" x="0" y="19" width="99" height="20"/>
				<textElement>
					<font isBold="false"/>
				</textElement>
				<text><![CDATA[Observaciones :]]></text>
			</staticText>
			<textField>
				<reportElement x="99" y="18" width="436" height="20"/>
				<textElement/>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{ensuma}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="3" y="39" width="531" height="15">
					<printWhenExpression><![CDATA[new java.lang.Boolean($P{internet}!=null)]]></printWhenExpression>
				</reportElement>
				<textElement>
					<font isBold="true" pdfFontName="Helvetica-Bold"/>
				</textElement>
				<text><![CDATA[Impreso por el paciente desde www.medilab.com.uy]]></text>
			</staticText>
		</band>
	</columnFooter>
	<pageFooter>
		<band splitType="Stretch"/>
	</pageFooter>
	<summary>
		<band splitType="Stretch"/>
	</summary>
</jasperReport>
